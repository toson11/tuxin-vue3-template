# 1. RESTful API

### 1.1 RESTful API简介

RESTful API是一种**基于HTTP协议**的API设计风格，它**使用HTTP动词**（GET、POST、PUT、DELETE等）来表示对资源的操作，**通过URL来定位资源**，通过HTTP**状态码来表示操作结果**。

### 1.2 RESTful API请求设计规范

1. URL使用名词，尽量用复数，与数据库表名称一致，如 `/users`
2. 使用HTTP动词表示操作，如 `GET/POST/PUT/PATCH/DELETE`
3. 使用嵌套表示资源之间的关系，如`/users/:id/posts`

### 1.3 RESTful API响应设计规范

1. 查询：允许添加限制条件来过滤返回数据
2. 分页
3. 字段过滤：只返回指定字段
4. HTTP状态码
   1. 信息响应
   2. 成功响应：200请求成功，201创建成功，204删除成功
   3. 重定向
   4. 客户端错误：401未授权，403禁止访问，404资源不存在
   5. 服务端错误
5. 错误处理
   1. 运行时错误，返回500
   2. 逻辑错误，如找不到404、先决条件失败412、参数错误422等
   3. koa自带错误处理中 `ctx.throw(404, 'Not Found')`
   4. 自定义错误中间件：不支持自定义404，但可以自定义其他错误
   5. koa-JSON-ERROR中间件：自动将错误转换为JSON格式

# 2. 安全性

1. 使用HTTPS协议
2. 使用鉴权，如JWT
3. 限流

# 3. 登录&认证

### 3.1 JWT简介

JWT（JSON Web Token）是一种**基于JSON的开放标准**，它**用于在各方之间安全地传输信息**，**通过数字签名来验证信息的完整性和真实性**。

### 3.2 JWT组成

- 头部Header：{ typ: "JWT", alg: "HS256" }，typ表示令牌类型，alg表示签名使用的算法
- 载荷Payload：需要传递的信息，包含过期时间、用户信息等，可加密
- 签名Signature：对Header和Payload进行加密，防止信息被篡改
  - `Signature = HMACSHA256(base64UrlEncode(header) + "." + base64UrlEncode(payload), secret)`

### 3.2 JWT与Session的区别

1. JWT是无状态的，Session是有状态的
2. JWT可以跨域，Session不能跨域
3. JWT可以存储在客户端，Session存储在服务器端（安全），session需实现多机共享
4. JWT可以存储更多的信息，Session存储的信息较少（可能查询数据库操作）
5. JWT安全性较高，**Session安全性较低**（cookie容易被CSRF）
6. Session可主动销毁，JWT需设置过期时间
7. Session结合cookie使用，较为灵活，兼容性好

# 4. 数据库

### 4.1 关系型数据库

- 使用场景: 当数据有明确的结构和关系时，比如用户、订单、产品等。
- 常用技术
  - MySQL：关系型数据库，支持事务，性能较高，但扩展性较差
  - PostgreSQL：关系型数据库，支持事务，性能较高，扩展性较好
  - Oracle：关系型数据库，支持事务，性能较高，扩展性较好

### 4.2 NoSQL非关系型数据库

- 使用场景: 当数据结构复杂，关系不明确时，或者需要高扩展性、高性能时，比如日志、用户行为、地理位置等。
- 常用技术：
  - MongoDB：文档型数据库，支持事务，性能较高，扩展性较好
  - Redis：键值对数据库，支持事务，性能较高，扩展性较好
  - Elasticsearch：搜索引擎数据库，支持事务，性能较高，扩展性较好

# 5. 统一错误处理

# 6. 统一响应格式

# 7. 参数校验

### 参数格式

### 参数缺失

## 参数转换

# 8. 接口文档
